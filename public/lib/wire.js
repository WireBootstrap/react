/* WireBootstrap Base Library v2.1.15 (2022-01-12) (c) 2016-2022 Enterprise Blocks, Inc. License details: https://www.wirebootstrap.com/license/wire */
if(!window.jQuery)throw"JQuery required for WireBootstrap library";var wire={post:function(e,t,n){n&&n.__wire_RequestId&&$.ajaxPrefilter(function(e,t,n){n.__wire_RequestId=e.__wire_RequestId});var i=$.extend({url:e,type:"POST",processData:!1,contentType:"application/json; charset=utf-8",data:null==t?null:JSON.stringify(t)},n);return $.ajax(i)},postWait:function(e,t,n){var i,r,a=$.extend({url:e,type:"POST",async:!1,contentType:"application/json; charset=utf-8",dataType:"json",data:null==t?null:JSON.stringify(t),success:function(e){i=e},error:function(e,t,n){r="object"==typeof e.responseJSON?e.responseJSON:"string"==typeof e.responseJSON?$.parseJSON(e.responseJSON):e.responseText?$.parseJSON(e.responseText):""}},n);if($.ajax(a),r)throw r;return i},get:function(e,t){var n=$.extend({url:e,type:"GET",dataType:"json"},t);return $.ajax(n)},getWait:function(e,t){var n,i,r=$.extend({url:e,type:"GET",async:!1,dataType:"json",success:function(e){n=e},error:function(e,t,n){i="object"==typeof e.responseJSON?e.responseJSON:"string"==typeof e.responseJSON?$.parseJSON(e.responseJSON):e.responseText?$.parseJSON(e.responseText):""}},t);if($.ajax(r),i)throw i;return n},expression:new function(){var self=this;this.eval=function(t,r,i,d){var s=null;if(t)if("function"==typeof t)s=t(r,i,d);else if(s=t,"({"==s.substring(0,2)){s=t.substring(1).substring(1,t.length-3);var fn="function f($row,$index,$data){return "+s+"}";eval(fn),s=f(r,i,d)}else if(t.indexOf("{")>-1)for(var prop in r)s=s.replaceAll("{"+prop+"}",r[prop]);return void 0===s?t:s}},Collection:function(e,t){var n=this,i=t||[];this.sort=function(e){i.sort((t,n)=>t[e]>n[e]?1:-1)},this.length=function(){return i.length},this.array=function(){return i},this.set=function(e){this.add(e)},this.add=function(t){return(Array.isArray(t)?t:[t]).forEach(function(t){var r=n.index(t[e]);r>-1?i[r]=t:i.push(t)}),t},this.clear=function(){i=[]},this.move=function(e,t){i.splice(t,0,i.splice(e,1)[0])},this.remove=function(t){var r=n.index("string"==typeof t?t:t[e]);r>-1&&i.splice(r,1)},this.get=function(e){var t=n.index(e);return t>-1?i[t]:null},this.index=function(t){var n=-1;return $.each(i,function(i,r){if(r[e]+"".toLowerCase()==t+"".toLowerCase())return n=i,!1}),n}},merge:function(e,t,n){for(var i in t)i in e&&"object"==typeof e[i]&&!Array.isArray(e[i])&&null!=e[i]?wire.merge(e[i],t[i],n):wire.toBoolean(n,!1)?"function"==typeof t[i]&&(e[i]=t[i]):e[i]=t[i];return e},deepClone:function(e,t){return wire.merge(e,t)},copyJSON:function(e){return JSON.parse(JSON.stringify(e))},isNumeric:function(e){return void 0!==e&&(!isNaN(parseFloat(e))&&isFinite(e))},isDate:function(e){return/^(0[1-9]|1[0-2])\/(0[1-9]|1\d|2\d|3[01])\/(19|20)\d{2}$/.test(e)},toBoolean:function(e,t){if("boolean"==typeof e)return e;if(null==e|void 0===e)return t;if("object"==typeof e)return!0;if(1==e)return!0;switch((e+"").toLowerCase()){case"true":case"yes":case"1":return!0;case"false":case"no":case"0":case null:return!1;default:return t||Boolean(e)}},isBoolean:function(e){if("boolean"==typeof e)return!0;if(null==e|void 0===e)return!1;if("object"==typeof e)return!1;if(1==e)return!0;switch(e+"".toLowerCase()){case"true":case"yes":case"false":case"no":return!0}},Format:function(e,t,n){return wire.format(e,t,n)},format:function(e,t,n){if(!t||void 0===e)return e;var i=e;switch(typeof t){case"string":var r=t,a=r.substring(1,3);switch(r.substring(0,1)+"".toUpperCase()){case"U":i=i.toUpperCase();break;case"N":wire.isNumeric(i)&&(i=l(i,a));break;case"C":wire.isNumeric(i)&&(i="$"+(i=l(i,a)));break;case"P":wire.isNumeric(i)&&(i=l(i*=100,a),i+="%");break;case"D":var s=new Date(i);i=(new Intl.DateTimeFormat).format(s)}break;case"object":var o=wire.merge({locale:"en-US",style:"decimal"},t);i=new Intl.NumberFormat(o.locale,o).format(i);break;case"function":i=t(e,n)}return i;function l(e,t){return new Number(e).toFixed(t).replace(/\B(?<!\.\d*)(?=(\d{3})+(?!\d))/g,",")}},guid:function(){function e(){return(65536*(1+Math.random())|0).toString(16).substring(1)}return(e()+e()+"-"+e()+"-4"+e().substr(0,3)+"-"+e()+"-"+e()+e()+e()).toLowerCase()},guidDom:function(){return wire.guid().replaceAll("-","_")},download:function(e){xhttp=new XMLHttpRequest,xhttp.onreadystatechange=function(){var t;4===xhttp.readyState&&(200===xhttp.status?((t=document.createElement("a")).href=window.URL.createObjectURL(xhttp.response),t.download=e.fileName||"file.txt",t.style.display="none",document.body.appendChild(t),t.click(),e.done&&e.done(xhttp)):e.fail&&e.fail({status:xhttp.status,statusText:xhttp.statusText,message:"Error {0} - {1}. See network call to {2} for details.".format(xhttp.status,xhttp.statusText,xhttp.responseURL)},xhttp),e.finally&&e.finally(xhttp))},xhttp.responseType=e.responseType||"blob";let t=null;e.data?(xhttp.open("POST",e.url),xhttp.setRequestHeader("Content-Type",e.contentType||"application/json; charset=utf-8"),t=JSON.stringify(e.data)):xhttp.open("GET",e.url),xhttp.send(t)},location:new function(){var e=this,t=null;this.pageName=function(){return window.location.pathname.split("/").pop()},this.scriptPath=function(e){var t=$("script[name='{0}'".format(e)),n="";if(t.length){var i=t.get(0);(i=(i=i.src).split("/")).pop(),n=i.join("/")}return n},this.currentScript=function(){var e="";return document.currentScript&&((e=(e=document.currentScript.src).split("/")).pop(),e=e.join("/")),e},this.path=function(n){return t=n.split("?")[1],e},this.removeParam=function(e){let t=new URL(window.location.href);return t.searchParams.delete(e),t.href},this.param=function(e){t||(t=(t=window.location.hash&&window.location.hash.indexOf("?")>-1?window.location.hash.substring(window.location.hash.indexOf("?")):window.location.search).slice(1));var n=null;return t.split("&").some(function(t){var i=t.split("=");return i[0].trim().toLowerCase()==e.toLowerCase()&&(n=i[1]),null!=n}),n&&"undefined"!=n?n:null},this.baseUrl=function(){return new RegExp(/^.*\//).exec(window.location.href)[0]}},when:function(e,t){var n=0;return function(i){n+=1,"boolean"!=typeof i||i||(n=e),n==e&&t&&t(i)}},loadCss:function(e,t){var n;if("string"==typeof e)n=e;else if(n=e.css,function(e){var t=$("<span class='{0}'></span>".format(e)),n=$("body").append(t).find(e),i="none"==n.css("display");return n.remove(),i}(e.hidden))return void(t&&t());if(-1!=n.indexOf(".css")){var i;i=(i=window.self!==window.top?window.frameElement.contentDocument:document).getElementsByTagName("head")[0];var r=document.createElement("link");if(r.setAttribute("rel","stylesheet"),r.setAttribute("href",n),t){var a=!1;r.onload=r.onreadystatechange=function(){a||this.readyState&&"complete"!=this.readyState&&"loaded"!=this.readyState||(a=!0,t())}}r.onerror=function(){t&&t()},i.appendChild(r)}},loadJs:function(e,t){Array.isArray(e)||(e=[e]);var n=0;e.forEach(function(i){var r,a,s=!0;if("string"==typeof i?r=i:(r=i.js,s=i.load,a=i.name),s){var o,l=r.split("/");r.split("/")[l.length-1];o=(o=window.self!==window.top?window.frameElement.contentDocument:document).getElementsByTagName("head")[0];var u=document.createElement("script");u.setAttribute("type","text/javascript"),u.setAttribute("src",r),a&&u.setAttribute("name",a),t&&(u.onload=u.onreadystatechange=function(){this.readyState&&"complete"!=this.readyState&&"loaded"!=this.readyState||(n+=1)==e.length&&t&&t()}),u.onerror=function(){t&&t()},o.appendChild(u)}else(n+=1)==e.length&&t&&t()})},require(e,t,n){var i=wire.requireType(e,t,function(e){n&&n(e?new e:null)});if(i){var r=new i;return n&&n(r),r}},requireType(e,t,n){function i(){var t=e.split("."),n=wire;return t.forEach(function(e,t){t>0&&(n=n[e])}),n}var r=i();if(r)return n&&n(r),r;t?wire.loadJs(t,function(){n(i())}):(console.log("{0} not found and main not supplied to load".format(e)),n(null))},splitRows:function(e,t){for(var n=t,i=0,r=[],a=0;a<e.length;a++)r[i]||(r[i]=[]),r[i].push(e[a]),r[i].length==n&&i++;return r},copy:function(e){if(Array.isArray(e)){var t=[];return e.forEach(e=>{t.push(wire.copy(e))}),t}var n={},i=JSON.parse(JSON.stringify(e));return wire.merge(n,i),wire.merge(n,e,!0),n}};if(Function.prototype.clone=function(){var e=this,t=function(){return e.apply(this,arguments)};for(var n in this)this.hasOwnProperty(n)&&(t[n]=this[n]);return t},String.prototype.splitUpperCase=function(){return this.split(/(?=[A-Z])/)},String.prototype.splitUpperCaseSpace=function(e){var t=this.splitUpperCase().join(" ");return void 0!=e&&e?t:t.substring(0,1).toUpperCase()+t.substring(1)},String.prototype.replaceAll=function(e,t){return this.replace(new RegExp(e,"gm"),t)},String.prototype.eval=function(e,t,n){return wire.expression.eval(this,e,t,n)},String.prototype.format=function(){for(var e=this,t=arguments.length;t--;)e=e.replace(new RegExp("\\{"+t+"\\}","gm"),arguments[t]);return e},String.prototype.endsWith=function(e){return this.substr(this.length-e.length)===e},String.prototype.startsWith=function(e){return this.substr(0,e.length)===e},Array.prototype.clone=function(){return JSON.parse(JSON.stringify(this))},"function"!=typeof window.CustomEvent){var ce=function(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n};CustomEvent.prototype=window.Event.prototype,window.CustomEvent=ce}wire.data={DataManager:new function(){this.DataSets=new wire.Collection("DataId",[])},DataEventManager:new function(){var e=this,t={};function n(e,n){t[e]||(t[e]={event:e,listeners:[]},n?document.getElementById(n).addEventListener("{0}".format(e),i):document.addEventListener("{0}".format(e),i))}function i(e){if(t[e.detail.event.name]){var n=e.detail.data,i={source:e,event:e.detail.event,data:n};t[e.detail.event.name].listeners.forEach(function(e){var t=e.data();switch(!0){case!t.columns.length&&!t.dataset&&!t.entities.length:case t.columns&&n.cell&&null!=new wire.Collection("column",t.columns).get(n.cell.column):case t.entities&&n.table&&n.table.__meta.dataset&&n.table.__meta.dataset.Query&&n.table.__meta.dataset.Query.Entities&&n.table.__meta.dataset.Query.Entities.length&&t.entities.indexOf(n.table.__meta.dataset.Query.Entities[0].Name)>-1:case t.dataset&&n.dataset&&t.dataset==n.dataset:case t.dataset&&n.table&&n.table.__meta.dataset&&n.table.__meta.dataset.DataId==t.dataset:t.when&&t.when(i)}})}}return this.event=function(e,i){n(e,i);var r=new wire.data.DataEventListner;return t[e].listeners.push(r),r},this.dataselect=function(){return e.event("dataselect.wire")},this.datawrite=function(){return e.event("datawrite.wire")},this.remove=function(e){e&&(document.removeEventListener("{0}".format(e),i),t[e]=null)},this},DataEventListner:function(){var e={columns:[],dataset:null,entities:[]};this.field=function(t){return e.columns.push({column:t}),this},this.column=function(e){return this.field(e)},this.entity=function(t){e.entities.push(t)},this.dataset=function(t){return e.dataset=t,this},this.when=function(t){return e.when=t,this},this.data=function(t){return t&&(e=t),e}},DataEventAction:{add:"add",remove:"remove",replace:"replace",clear:"clear"},DataEvent:function(e){var t,n,i,r={action:wire.data.DataEventAction.replace,expression:null,cell:null,column:null,row:null,table:null},a="string"==typeof e?null:e;return this.element=function(e){return i=e,this},this.getDispatchEvent=function(){return n},this.datadrilldown=function(){return t="datadrilldown.wire",this},this.dataselect=function(){return t="dataselect.wire",this},this.source=function(e){return a=e,this},this.getData=function(){return r},this.expression=function(e){return e&&(r.expression=e),this.eq=function(){return r.expression=(new wire.data.EqualsExpression).__typeName,this},this.ne=function(){return r.expression=(new wire.data.NotEqualsExpression).__typeName,this},this.starts=function(){return r.expression=(new wire.data.StartsExpression).__typeName,this},this.contains=function(){return r.expression=(new wire.data.ContainsExpression).__typeName,this},this.between=function(){return r.expression=(new wire.data.BetweenExpression).__typeName,this},this},this.action=function(e){return e&&(r.action=e),this.add=function(){return r.action=wire.data.DataEventAction.add,this},this.remove=function(){return r.action=wire.data.DataEventAction.remove,this},this.clear=function(){return r.action=wire.data.DataEventAction.clear,this},this.replace=function(){return r.action=wire.data.DataEventAction.replace,this},this},this.data=function(e){return r=e,this},this.cell=function(e,t,n,i){return r.cell={column:e,value:t,text:n,type:i},this},this.label=function(e,t){return r.cell.label="{0} = {1}".format(e.splitUpperCaseSpace(),t),this},this.column=function(e){return r.column=e,this},this.row=function(e){return r.row=e,this},this.table=function(e){return r.table=e,this},this.raise=function(){var e=new CustomEvent("{0}".format(t),{detail:{event:{name:t,source:a},data:r}});return n=i?document.getElementById(i).dispatchEvent(e):document.dispatchEvent(e),this},this.event=function(e){return t=e,this},this},DataPromise:function(e){var t,n,i,r,a,s,o,l,u;return o=e,this.promise=function(e){return e&&(s=e),s},this.always=function(e){return(o||l)&&e(),a=e,u=!1,this},this.resolve=function(e){e&&(o=e),t&&(i?i(o,function(e){t(e)}):t(o)),a&&a(o)},this.done=function(e){return o&&(i?i(o,function(t){e(t)}):e(o)),t=e,this},this.beforeDone=function(e){return i=e,this},this.reject=function(e){l=e,r&&r(l),a&&a(null,l)},this.fail=function(e){return r=e,l&&e(l),this},this.process=function(){u=!0,n&&n()},this.processing=function(e){return n=e,u&&e(u),this},this},DataSet:function(e){var t=this;this.__typeName="DataSet",this.DataId=wire.guid(),this.Source=null,this.Query=null,this.Events=[],this.Transform=null,this.TransformFn=null,this.__meta={},this.isDataSet=!0,this.Entity=null,this.Write=null;var n=null,i=[],r=[],a=null;function s(e,n){var i=e||{};if("object"==typeof i.params)for(var r in(i=$.extend(!0,{},i)).params)"function"==typeof i.params[r]&&(i.params[r]=i.params[r](n,t));return i}function o(e){t.Events=t.Events||[];var n=new wire.Collection("Name",t.Events);return e&&!n.get(e)&&t.Events.push({Name:e}),n}function l(e,s,o){var l=null;if(o||(l=new wire.data.DataPromise,r.push({p:l,v:e,c:s})),!a&&!n|o){r.forEach(function(e){e.p.process()}),a=t.Source.execAsync(t.Query,s).done(function(e,o,l){a=null,s&&!wire.toBoolean(s.cast,!0)?n=e:(n=t.Source.getResponseTable(e,l),Array.prototype.push.apply(i,n.Columns));let u=!1;for(var d=r.length-1;d>=0;d--){var f=r[d],h=f.v?n[f.v](f.c):n;function p(e){e?f.p.reject():f.p.resolve(n),f.c&&f.c.onetime&&r.splice(d,1)}u?p():c(h,f.c,f.p,function(e,t){u=!0,n=e,p(t)})}}).fail(function(e){if(a=null,e.getAllResponseHeaders().indexOf("x-wirebootstrap-redirect")>-1){let t=e.getAllResponseHeaders().trim().split(/[\r\n]+/).map(e=>{const t=e.split(": ");return{name:t[0],value:t[1]}});location.href=new wire.Collection("name",t).get("x-wirebootstrap-redirect").value}else r.forEach(function(t){t.p.reject(e)})})}if(!o){if(a)l.promise(a.promise);else if(n){var u=n[e]?n[e](s):n;l.resolve(u),s&&s.onetime&&r.splice(r.length-1,1)}return l}function c(e,n,i,r){n&&!wire.toBoolean(n.cast,!0)||(e.__meta.model=t.Model||null,e.__meta.dataset=t);var a=t.View||t.Transform;if(a)try{a({table:e,config:n,dataset:t},function(e){r(e)})}catch(e){i.reject(e)}else r(e)}}this.setTransform=function(e){view&&(t.TransformFn=e),t.TransformFn&&(t.Transform=new Function("data, callback",t.TransformFn))},this.clearPromises=function(){r=[]},this.updatePromises=function(){r.forEach(function(e){e.p.resolve(n)})},this.event=function(e){return this.on(e)},this.on=function(e){var n=null,i=null;return e&&((n=o(e).get(e)).Listener?i=n.Listener:(i=wire.data.DataEventManager.event(e,n.ListenerId),n.Listener=i,t.Query.Entities&&t.Query.Entities.forEach(function(e){i.entity(e.Name)}),i.when(function(e){var n=e.data,i=o().get(e.event.name);if(!i)return;var r,a=t.Query,s=!1,l=n.table&&n.table.__meta.dataset&&n.table.__meta.dataset.DataId==t.DataId;!l&&t.Query.Paging&&t.Query.Paging.Page>0&&(t.Query.Paging.Page=1);var u=function(e){var t=null;i.Fields&&i.Fields.some(function(n){return n.Alias==e&&(t=n.Name),null!=t});return t}(n.cell.column)||n.cell.column;i.Fields&&(r=new wire.Collection("Name",i.Fields).get(u));r&&r.When&&!l?(a instanceof wire.data.TableQuery||a instanceof wire.data.StoredProcedure?r.When({dataset:t,event:e},c):r.When(a.dimension(u),n.cell.value,a,e),s=!0):c();function c(){var e=wire.data.DataEventAction;if(wire.model&&a instanceof wire.model.PivotQuery){var r=a.getDimension(u).Filter.Selections;switch(i.Name){case"datadrilldown.wire":if(n.table&&n.table.__meta.dataset.DataId==t.DataId){switch(n.action){case e.replace:a.dimension(u).children(n.cell.value);break;case e.add:var o=new wire.model.FilterSelection;o.Expression=new wire.model.ChildrenExpression(n.cell.value),o.Operation=wire.model.FilterSelectionOperation.AddToFilter,r.push(o);break;case e.remove:var c=!1;if(r.some(function(e,t){return"ChildrenExpression"==e.Expression.__typeName&&e.Expression.Member.UniqueName==n.cell.value&&(r.splice(t,1),c=!0),c}),!c){var o=new wire.model.FilterSelection;o.Expression=new wire.model.ChildrenExpression(n.cell.value),o.Operation=wire.model.FilterSelectionOperation.RemoveFromFilter,r.push(o)}}s=!0}break;case"dataselect.wire":a.dimension(u).members(n.cell.value),s=!0}}else{var d=n.table&&n.table.__model?n.table.__model.getDimension(u):null;switch(i.Name){case"datadrilldown.wire":if(n.table.__dataSet.DataId==t.DataId)switch(n.action){case e.replace:switch(!0){case null!=d.ParentId&&void 0!=d.ParentId:a.where().eq(d.ParentId,n.row[d.Id]),s=!0;break;case null!=d.Hierarchy&&void 0!=d.Hierarchy:var f=0;d.Hierarchy.forEach(function(e,t){var t=a.Fields.indexOf(e);t>-1&&a.Fields.splice(t,1),e==u&&(f=t)}),f<d.Hierarchy.length-1&&(a.Fields.splice(0,0,d.Hierarchy[f+1]),a.groupBy(d.Hierarchy[f+1]),a.where().eq(u,n.cell.text),s=!0)}}break;case"dataselect.wire":if(!l)if("StoredProcedure"==a.__typeName)s=a.setEventExpression({column:u,data:n});else{n.column=n.column||{},n.column.Name=n.column.Name||n.cell.column;var h={Entity:n.column?n.column.Table:null,Field:n.column.Name,Value:n.cell.value},p=a.getFields(h.Field);p.length&&(h.EventName=p[0].EventName);var v=a.getEventNameFields(n.column.Name);let t=n.column.Table;if(v.length){var m=[];m=Array.isArray(n.cell.value)?n.cell.value:[n.cell.value],v.forEach(function(e,i){u=e.Name,t=e.Entity,h.Field=e.Name,h.Entity=e.Entity,h.EventName=n.column.Name,m.length>i&&(h.Value=m[i]),w()})}else w();function w(){switch(n.action){case e.add:case e.replace:n.action==e.replace&&a.clear(u,t),n.expression?a.setEventExpression(n.expression,h):Array.isArray(h.Value)?a.in(h):a.eq(h);break;case e.remove:h.removeJoin=!0,a.removeFilter(h);break;case e.clear:a.clear(u)}}s=!0}}}}s&&t.refresh()}))),this.fields=function(){if(e){var n=new wire.Collection("Name",t.Events).get(e),r=n&&n.Fields?n.Fields:[],a=$.extend(!0,[],r),s=new wire.Collection("Name",a),o=null;function l(e){if(wire.toBoolean(e.Events,!0)){o._found=!0;var t=o.Name||e.Name||e.Field||o.Alias||e.Alias;t&&i.column(t),e.EventName&&i.column(e.EventName),e.EventNames&&e.EventNames.forEach(function(e){i.column(e)})}}void 0!=wire.model&&t.Query instanceof wire.model.PivotQuery?t.Query.Dimensions.forEach(function(e){i.column(e.UniqueName)}):"StoredProcedure"==t.Query.__typeName?t.Query.Params.forEach(function(e){o=s.get(e.Name)||{},l(e)}):t.Query.Fields&&(t.Query.Fields.forEach(function(e){o=s.get(e.Name)||{},l(e)}),t.Query.Filter.forEach(function(e){(o=e.Expression.Field?s.get(e.Expression.Field):{})||(o={}),l(e.Expression)})),a.forEach(function(e){o=e,wire.toBoolean(e._found,!1)||l(e)})}},this.field=function(t){i.column(t);var n=o().get(e);return n.Fields=n.Fields||[],fld=new wire.Collection("Name",n.Fields).get(t),fld||(fld={Name:t},n.Fields.push(fld)),this},this.when=function(e){return fld.When=e,this},this.dataselect=function(){return t.on("dataselect.wire")},this.datadrilldown=function(){return t.on("datadrilldown.wire")},this},this.data=function(e){return void 0!==e&&(n=e),n},this.table=function(e){return t.data(e)},this.execAsync=function(e){return t.getData(e),a},this.execAsyncListen=function(e){return t.ensureData(e)},this.getData=function(e){return t.data(null),(e=e||{}).onetime=!0,t.ensureData(e)},this.refresh=function(){l(null,null,!0)},this.refreshData=function(e){return t.data(null),t.ensureData(e)},this.ensureData=function(e){return l(null,e)},this.dataTable=function(e){return l("dataTable",e)},this.dimensionTable=function(e){return l("dimensionTable",e)},this.flatTable=function(e){return l("flatTable",e)},this.delete=function(e,n){if(n=n||{},t.Source){if(!t.Source.serviceProvider().delete)throw"Service provider does not support deleting data";t.Source.delete(e,s("object"==typeof t.Delete?t.Delete:t.Write),null),wire.toBoolean(n.refresh,!0)&&t.refresh()}},this.write=function(e,r){if(t.Source){if(t.Write=t.Write||{},!t.Source.serviceProvider().write)throw"Service provider does not support writing data";var a=t.Write.Options||t.Write.Provider||{};t.Write.Keys&&(a.Keys=t.Write.Keys),t.Write.Refresh&&(a.refresh=t.Write.Refresh),t.Write.Refresh&&(a.refresh=t.Write.Refresh),t.Write.RemoveNonDatasetColumns&&(a.removeNonDatasetColumns=t.Write.RemoveNonDatasetColumns),r&&(a=$.extend(a,r));try{var o=e;Array.isArray(e)||(o=[e]);var l=new wire.data.DataTable(i),u=$.extend(!0,[],o),c=new wire.data.DataTable(u);wire.toBoolean(a.removeNonDatasetColumns,!0)&&c.Rows.forEach(function(e){n instanceof wire.data.DataTable&&c.Columns.forEach(function(t){null==l.where().eq("Name",t.Name).first()&&delete e[t.Name]})});var d=u;"object"==typeof t.Write&&"function"==typeof t.Write.Data&&(d=t.Write.Data(d,t));var f=t.Source.write(t.Write.Entity||t.Query.Entities[0].Name,d,s(a,d));return wire.toBoolean(a.refresh,!1)&&t.refresh(),f}catch(e){throw e}}},this.initialize=function(){if($.extend(this,e),t.Query&&t.Events){var n=o().get("dataselect.wire");n&&!wire.toBoolean(n.Listen,!0)||t.on().dataselect().fields(),(n=o().get("datadrilldown.wire"))&&!wire.toBoolean(n.Listen,!0)||t.on().datadrilldown().fields()}return wire.data.DataManager.DataSets.add(this),this},t.initialize(e)},DataSource:function(e,t){var n=this;this.__typeName="DataSource",this.Ajax=null,this.ServiceRoot=null,this.ProviderId=null,this.ProviderMain=null,this.Provider=null,this.Model=null;var i={method:null},r=null;function a(e,t,r){var a=wire.guid();return i[a]={method:e,query:t,options:r},function(e){var t=i[e].query;if(!n.Model||"StoredProcedure"==t.__typeName)return;var r=[];let a=new wire.Collection("Name",r);t.Fields.forEach(function(e){e.Entity||1!=t.Entities.length||(e.Entity=t.Entities[0].Name);var i=n.Model.getField(e.Name,e.Entity);i&&wire.merge(e,i)}),t.Entities.forEach(function(e){r.push({Name:e.Name})}),t.Fields.forEach(function(e){e.Entity&&!a.get(e.Entity)&&r.push({Name:e.Entity})}),t.Filter.forEach(function(e){e.Expression&&e.Expression.Entity&&!a.get(e.Expression.Entity)&&r.push({Name:e.Expression.Entity})});var s=new wire.data.DataTable(n.Model.Relationships),o=new wire.data.DataTable(r),l=[];t.Joins=t.Joins||[],o.addColumn("processed").value(!1),s.addColumn("used").value(!1),s.addColumn("pos"),s.addColumn("other"),s.addColumn("first"),o.Rows.length&&(o.Rows[0].processed=!0);var u=!0;do{o.Rows.forEach(function(e,t){if(!e.processed){var n=c(e);d(e,n)||f(e,n)}}),u=!u}while(null!=o.where().eq("processed",!1).first()&&0==u);function c(e){var t=s.where().eq("used",!1).calc(function(t){return t.pos=null,t.Entity1==e.Name&&(t.pos=1,t.other=t.Entity2),t.Entity2==e.Name&&(t.pos=2,t.other=t.Entity1),null!=t.pos}).table();return t}function d(e,t){var n=t.where().calc(function(e){var t=null!=o.where().eq("Name",e.other).eq("processed",!0).first();return t}).first();if(null!=n){n.first=n.pos,l.push(n),n.used=!0;var i=o.where().eq("Name",n.Entity1).first();i.processed=!0,(i=o.where().eq("Name",n.Entity2).first()).processed=!0}return null!=n}function f(e,t){t.Rows.some(function(t){var n=s.where().eq("used",!1).calc(function(n){return n.Entity1==t.other&&null!=o.where().ne("Name",e.Name).eq("Name",n.Entity2).eq("processed",!0).first()?(n.first=1,t.first=t.pos):n.Entity2==t.other&&null!=o.where().ne("Name",e.Name).eq("Name",n.Entity1).eq("processed",!0).first()&&(n.first=2,t.first=t.pos),null!=n.first}).first();if(null!=n){l.push(n),l.push(t),t.used=!0,n.used=!0;var i=o.where().eq("Name",n.Entity1).first();return i&&(i.processed=!0),(i=o.where().eq("Name",n.Entity2).first())&&(i.processed=!0),(i=o.where().eq("Name",t.Entity1).first())&&(i.processed=!0),(i=o.where().eq("Name",t.Entity2).first())&&(i.processed=!0),!0}return!1})}l.forEach(function(e){var n,i,r,a;1==e.first?(n=e.Entity1,r=e.Field1,i=e.Entity2,a=e.Field2):(n=e.Entity2,r=e.Field2,i=e.Entity1,a=e.Field1);const s=t.Joins.some(e=>e.Table1==n&&e.Field1==r&&e.Table2==i&&e.Field2==a||e.Table2==n&&e.Field2==r&&e.Table1==i&&e.Field1==a);s||t.join(n,r).on(i,a)}),s.removeColumn("used"),s.removeColumn("pos"),s.removeColumn("other"),s.removeColumn("first"),o.removeColumn("processed")}(a),(r=r||{}).__wire_RequestId=a,r}function s(e,t){if(n.Model&&t&&e.Columns){var r=i[t],a=r.options;if(!a||wire.toBoolean(a.applyModel,!0))switch(r.method){case"exec":var s=new wire.data.DataTable(n.Model.Fields),o=[];"TableQuery"==r.query.__typeName?o=r.query.Entities:o.push({Name:r.query.Name}),e.Columns.forEach(function(t){var n=!1;o.some(function(i){var r=s.where().eq("Entity",i.Name).eq("Name",t.Name).first();return r||(r=s.where().eq("Entity","*").eq("Name",t.Name).first()),r&&(t.Title=r.Alias||t.Title,t.Format=r.Format||t.Format,r.Calc&&e.addColumn(r.Name).title(r.Alias||r.Name.splitUpperCaseSpace()).format(r.Format).calc(r.Calc),n=!0),n})});break;case"discoverEntities":n.Model.Entities.forEach(function(t){var n=e.where().eq("Name",t.Name).first();n&&(n.Alias=t.Alias||n.Alias,t.Hidden&&e.delete().eq("Name",t.Name))});break;case"discoverFields":n.Model.Fields.forEach(function(t){var n=e.where().eq("Entity",t.Entity).eq("Name",t.Name).first();n&&(n.Alias=t.Alias||n.Alias,t.Hidden&&e.delete().calc(function(e){return e.Entity==t.Entity&&e.Name==t.Name}))})}}}this.useBasicAuth=function(e,t){n.Ajax=n.Ajax||{},n.Ajax.Headers={Authorization:"Basic "+window.btoa(e+":"+t)}},this.ensureServiceProvider=function(e){n.serviceProvider()?e&&e({}):n.ProviderMain?wire.loadJs(n.ProviderMain,function(){e({})}).fail(function(t){e({ex:t})}):console.log("Unable to locate DataSource service provider '{0}'".format(n.ProviderId))},this.serviceProvider=function(){if(!r){var e=wire.data.provider.Providers[n.ProviderId];e&&(r=new e.provider({dataSource:this}))}return r},this.allow=function(){const e=this.serviceProvider();if(e)return e.allow},this.getResponseTable=function(e,t){var i=n.serviceProvider().getResponseTable(e);return s(i,t?t.__wire_RequestId:null),i},this.getEntityResponseTable=function(e){var t=n.serviceProvider().getEntityResponseTable(e);return s(t),t},this.test=function(e){return n.serviceProvider().test(e)},this.discoverEntities=function(e){return i={method:"discoverEntities",options:e},n.serviceProvider().discoverEntities(e)},this.discoverEntitiesAsync=function(e){return i={method:"discoverEntities",options:e},n.serviceProvider().discoverEntitiesAsync(e)},this.discoverFields=function(e){i={method:"discoverFields",options:e};var t=n.serviceProvider().discoverFields(e);return s(t),t},this.discoverFieldsAsync=function(e){return i={method:"discoverFields",options:e},n.serviceProvider().discoverFieldsAsync(e)},this.discoverCatalogs=function(e){return i={method:"discoverCatalogs",options:e},n.serviceProvider().discoverCatalogs(e)},this.discoverCatalogsAsync=function(e){return i={method:"discoverCatalogs",options:e},n.serviceProvider().discoverCatalogsAsync(e)},this.discoverProcedures=function(e){return i={method:"discoverProcedures",options:e},n.serviceProvider().discoverProcedures(e)},this.discoverProceduresAsync=function(e){return i={method:"discoverProcedures",options:e},n.serviceProvider().discoverProceduresAsync(e)},this.discoverProcedureParameters=function(e){return i={method:"discoverProcedureParameters",options:e},n.serviceProvider().discoverProcedureParameters(e)},this.discoverProcedureParametersAsync=function(e){return i={method:"discoverProcedureParameters",options:e},n.serviceProvider().discoverProcedureParametersAsync(e)},this.exec=function(e,t){t=a("exec",e,t);var i=n.serviceProvider().exec(e,t);return s(i,t.__wire_RequestId),i},this.execAsync=function(e,t){return t=a("exec",e,t),n.serviceProvider().execAsync(e,t)},this.delete=function(e,t){return n.serviceProvider().delete(e,t)},this.deleteAsync=function(e,t){return n.serviceProvider().deleteAsync(e,t)},this.write=function(e,t,i){return n.serviceProvider().write(e,t,i)},this.writeAsync=function(e,t,i){return n.serviceProvider().writeAsync(e,t,i)},function(t){wire.merge(n,t),n.ProviderId=n.ProviderId||e,n.Provider||(n.Provider={})}(t)},FilterSelection:function(e,t){var n=this;this.__typeName="FilterSelection",this.Expression=e,this.Operation=t||wire.data.FilterSelectionOperation.NotSet,this.getDescription=function(e){return n.Expression&&n.Expression.getDescription?n.Expression.getDescription(e):""}},FilterSelectionOperation:{NotSet:"NotSet",And:"And",Or:"Or"},EntityExpression:function(e,t){this.__typeName="EntityExpression",this.Name=e,this.Qualifier=t},InExpression:function(e,t){var n=this;this.__typeName="InExpression",this.Field=null,this.Entity=null,this.Alias=null,this.Value=t,this.getDescription=function(e){var t="",i="",r=n.Field.splitUpperCaseSpace();if(e&&e.model){var a=e.model.getField(n.Field,n.Entity);r=a&&a.Alias?a.Alias:r}return n.Value&&(1==n.Value.length?(t=" = ",i=n.Value):(t=" in ",i=n.Value.join(","))),"{0}{1}{2}".format(r,t,i)},this.tojSQL=function(){return'.in("{0}",[{1}])'.format(n.Field,$.map(n.Value,function(e){return"number"==typeof e?e:'"'+e+'"'}).join(", "))},"object"==typeof e?$.extend(this,e):n.Field=e},_EqualsExpression:function(e,t,n,i){var r=this;this.__typeName=i?"NotEqualsExpression":"EqualsExpression",this.Field=e,this.Entity=n,this.Alias=null,this.Value=t,this.getDescription=function(e){var t=r.Field.splitUpperCaseSpace();let n="";if(e&&e.model){var a=e.model.getField(r.Field,r.Entity);t=a&&a.Alias?a.Alias:t}return n=e.valueOnly?r.Value:"{0} {1} {2}".format(t,i?"<>":"=",r.Value),e.format&&(n=e.format({field:r.Field,value:r.Value,description:n})),n},this.tojSQL=function(){return'.{0}("{1}",{2})'.format(i?"ne":"eq",r.Field,"number"==typeof this.Value?r.Value:'"'+r.Value+'"')+")"},"object"==typeof e&&$.extend(this,e)},StartsExpression:function(e,t){this.__typeName="StartsExpression",this.Field=e,this.Value=t,this.tojSQL=function(){return'.starts("{0}",{1})'.format(this.Field,"number"==typeof this.Value?this.Value:'"'+this.Value+'"')+")"}},BetweenExpression:function(e,t,n){this.__typeName="BetweenExpression",this.Entity=null,this.Field=e,this.Value1=t,this.Value2=n},FieldExpression:function(e,t,n,i){var r=this;this.__typeName="FieldExpression",this.Entity=n,this.Field=e,this.Entity2=i,this.Field2=t,this.tojSQL=function(){return'.eqField("{0}","{1}")'.format(this.Field1,this.Field2)},this.getDescription=function(){return""},this.isSameFieldExpression=function(){return r.Entity==r.Entity2&&r.Field==r.Field2},"object"==typeof e&&$.extend(this,e)},ContainsExpression:function(e,t){this.__typeName="ContainsExpression",this.Field=e,this.Value=t,this.tojSQL=function(){return'.contains("{0}",{1})'.format(this.Field,"number"==typeof this.Value?this.Value:'"'+this.Value+'"')+")"}},OrderByExpression:function(e,t){this.__typeName="OrderByExpression",this.Field=null,this.Entity=null,this.Alias=null,this.Desc=t||!1,"object"==typeof e?$.extend(this,e):this.Field=e},QueryExpression:new function(){this.cast=function(e){var t=null;if(e)switch(e.__typeName){case"EqualsExpression":t=$.extend(new wire.data.EqualsExpression,e);break;case"NotEqualsExpression":t=$.extend(new wire.data.NotEqualsExpression,e);break;case"ContainsExpression":t=$.extend(new wire.data.ContainsExpression,e);break;case"StartsExpression":t=$.extend(new wire.data.StartsExpression,e);break;case"InExpression":t=$.extend(new wire.data.InExpression,e);break;case"FieldExpression":t=$.extend(new wire.data.FieldExpression,e)}return t}},CustomExpression:function(e,t){var n=this;this.__typeName="CustomExpression",this.Expression=e,this.Description=t,this.getDescription=function(){return n.Description||n.Expression}},StoredProcedure:function(e,t,n){var i=this;this.__typeName="StoredProcedure",this.Name=e||null,this.Params=t||[],this.Options={useFirstInArray:!1};var r=null;this.options=function(e){return i.Options=e,i},this.getParamDescription=function(e){var t=[];return i.Params.forEach(function(n){if(n.Value&&wire.toBoolean(n.Visible,!0)){let i=wire.expression.eval(n.Description,n);i||(i=n.Value,e.valueOnly||(i=n.Name.splitUpperCaseSpace()+" = "+n.Value)),e.format&&(i=e.format({field:n.Name,value:n.Value,description:i})),t.push(i)}}),t.join(", ")},this.param=function(e,t){return r="object"==typeof e?e:{Name:e,Value:t},i.Params.push(r),this},this.eventName=function(e){r&&(r.EventName=e)},this.getParam=function(e){return new wire.Collection("Name",i.Params).get(e)},this.setEventExpression=function(e){var t=e.column,n=e.data,r=wire.data.DataEventAction,a=[];i.Params.forEach(function(e){e.Name==t?a.push(e):e.EventName&&e.EventName==t&&a.push(e)});var s=Array.isArray(n.cell.value)?n.cell.value:[n.cell.value],o=0;return a.forEach(function(e){n.action==r.clear||n.action==r.remove?(e.Value=null,e.Description=null):(e.Description=n.cell.label,a.length>1?(e.Value=s[o],o+1<s.length&&(o+=1)):e.Value=s.join("|"))}),a.length},n&&$.extend(this,n)},TableDelete:function(){return this.__typeName="TableDelete",this.Entity=null,this.Filter=[],this.from=function(e){return e&&(this.Entity=e),this},this.where=function(e){return this.Filter=[],e&&this.Filter.push(new wire.data.FilterSelection(new wire.data.CustomExpression(e))),this},this.contains=function(e,t){return this.Filter.push(new wire.data.FilterSelection(new wire.data.ContainsExpression(e,t))),this},this.eq=function(e,t,n,i){var r=t;return"text"==i&&(r="'"+r+"'"),this.Filter.push(new wire.data.FilterSelection(new wire.data.EqualsExpression(e,r,n))),this},this.ne=function(e,t,n,i){var r=t;return"text"==i&&(r="'"+r+"'"),this.Filter.push(new wire.data.FilterSelection(new wire.data.NotEqualsExpression(e,r,n))),this},this.in=function(e,t,n){var i=t;return"text"==n&&(i="'"+i+"'"),this.Filter.push(new wire.data.FilterSelection(new wire.data.InExpression(e,i))),this},this.expression=function(e){return this.Filter.push(new wire.data.FilterSelection(new wire.data.CustomExpression(e))),this},this},Field:function(e,t){var n=this;this.Name=null,this.Entity=null,this.Alias=null,this.Hidden=null,this.label=function(){return n.Alias||n.Name},this.description=function(){var e="";return n.Aggregate&&(e+=n.Aggregate+" ( "),n.Entity&&(e+="[ {0} ] . ".format(n.Entity)),e+"[ {0} ]".format(n.Field||n.Name)+(n.Aggregate?" )":"")},$.extend(this,e),t&&$.extend(this,t.getField(this))},TableQuery:function(){var e=this;this.__typeName="TableQuery",this.Data=!1,this.Distinct=!1,this.Top=0,this.Fields=[],this.Entities=[],this.Filter=[],this.Expand=[],this.OrderBy=[],this.Joins=[],this.GroupBy=[],this.Paging={Page:0,Rows:0},this.Custom=null;var t=null,n=null;function r(i,r,a){return t={Type:i,Table1:a?r:n,Field1:a||r},e.Joins.push(t),e}return this.data=function(){return this.Data=!0,this},this.distinct=function(){return this.Distinct=!0,this},this.field=function(e){var t;return t="object"==typeof e?e:{Name:e},this.Fields.push(t),this.eventName=function(e){t.EventName=e},this.as=function(e){return t.Alias=e,this},this},this.fields=function(){if(arguments&&arguments.length>0)for(i=0;i<arguments.length;i++)e.field(arguments[i]);return this},this.from=function(t){t&&(new wire.data.DataTable(e.Entities).where().eq("Name",t).first()||this.entity(t));return this},this.where=function(t){return e.Filter=[],t&&e.Filter.push(new wire.data.FilterSelection(new wire.data.CustomExpression(t))),this},this.custom=function(t){return e.Custom=t,this},this.top=function(t){return e.Top=t,this},this.format=function(e,t){return this.entity(e.format(t)),this},this.join=function(e,t){return r("inner",e,t)},this.leftJoin=function(e,t){return r("left",e,t)},this.rightJoin=function(e,t){return r("right",e,t)},this.fullJoin=function(e,t){return r("full",e,t)},this.on=function(e,i){return t.Table2=i?e:n,t.Field2=i||e,this},this.entity=function(t,i){return n=t,e.Entities.push(new wire.data.EntityExpression(t,i)),this},this.attribute=function(e){return this.Entities.push(new wire.data.EntityExpression("attribute",e||null)),this},this.clear=function(t,n){var i=[];e.Filter.forEach(function(e,r){var a=wire.data.QueryExpression.cast(e)||e;a.Expression.Field==t&&(n?a.Expression.Entity==n&&i.push(r):i.push(r))});for(var r=i.length-1;r>=0;r--)e.Filter.splice(i[r],1);return this},this.page=function(t,n){return e.Paging.Page=t,void 0!==n&&(e.Paging.Rows=n),this},this.contains=function(e,t){return this.Filter.push(new wire.data.FilterSelection(new wire.data.ContainsExpression(e,t))),this},this.starts=function(e,t){return this.Filter.push(new wire.data.FilterSelection(new wire.data.StartsExpression(e,t))),this},this.between=function(e,t,n){return this.Filter.push(new wire.data.FilterSelection(new wire.data.BetweenExpression(e,t,n))),this},this.in=function(e,t,n){var i=t;return"text"==n&&(i="'"+i+"'"),this.Filter.push(new wire.data.FilterSelection(new wire.data.InExpression(e,i))),this},this.eq=function(e,t,n,i){var r=t;return"text"==i&&(r="'"+r+"'"),this.Filter.push(new wire.data.FilterSelection(new wire.data.EqualsExpression(e,r,n))),this},this.filter=function(t,n){return Array.isArray(fields)||(fields=[fields]),fields.forEach(function(t){e.eqField(t,t)}),this},this.eqField=function(e,t,n,i){return t||(t=e),i||(i=n),this.Filter.push(new wire.data.FilterSelection(new wire.data.FieldExpression(e,t,n,i))),this},this.ne=function(e,t,n,i){var r=t;return"text"==i&&(r="'"+r+"'"),this.Filter.push(new wire.data.FilterSelection(new wire.data.NotEqualsExpression(e,r,n))),this},this.param=function(t,n,i){return e.eq(t,n,i)},this.setEventExpression=function(t,n){switch(t){case"EqualsExpression":e.eq(n.Field,n.Value);break;case"StartsExpression":e.starts(n.Field,n.Value);break;case"ContainsExpression":e.contains(n.Field,n.Value);break;case"StartsExpression":e.starts(n.Field,n.Value);break;case"BetweenExpression":Array.isArray(n.Value)&&e.between(n.Field,n.Value[0],n.Value[1])}},this.expression=function(e,t){return this.Filter.push(new wire.data.FilterSelection(new wire.data.CustomExpression(e,t))),this},this.expand=function(e){for(i=0;i<arguments.length;i++)this.Expand.push(arguments[i]);return this},this.orderBy=function(e,t){return this.OrderBy.push(new wire.data.OrderByExpression(e,t)),this},this.groupBy=function(e){for(i=0;i<arguments.length;i++){var t;t="string"==typeof arguments[i]?{Field:arguments[i]}:arguments[i],this.GroupBy.push(t)}return this},this.expandData=function(){return this.expand("data")},this.getEventNameFields=function(t){var n=[];return e.Fields&&e.Fields.forEach(function(e){e.EventName&&e.EventName==t&&n.push({Name:e.Name,Entity:e.Entity})}),e.Filter&&e.Filter.forEach(function(e){e.Expression.EventName&&e.Expression.EventName==t&&n.push({Name:e.Expression.Field,Entity:e.Expression.Entity})}),n},this.getFields=function(t,n){var i=[];return e.Fields&&e.Fields.forEach(function(e){e.Entity&&n?e.Entity==n&&e.Name==t&&i.push(e):void 0!==t?e.Name==t&&i.push(e):i.push(e)}),e.Filter&&e.Filter.forEach(function(e){var r=e.Expression;r.Entity&&n?r.Entity==n&&r.Field==t&&i.push(r):void 0!==t?r.Field==t&&i.push(r):i.push(r)}),i},this.getFilterFields=function(){var t=[];return e.Filter.forEach(function(e){var n=e.Expression;t.push({Name:n.Field,Alias:n.Alias,Entity:n.Entity})}),t},this.removeField=function(t,n){for(var i=e.Fields.length-1;i>=0;i--){const r=e.Fields[i];r.Name==t&&(n?n==r.Entity&&e.Fields.splice(i,1):e.Fields.splice(i,1))}},this.removeGroupBy=function(t){for(var n=e.GroupBy.length-1;n>=0;n--)e.GroupBy[n].Field==t&&e.GroupBy.splice(n,1)},this.removeFilter=function(t,n,i){var r=[],a=!1,s=[];"object"==typeof t&&(n=t.Value,i=t.Entity,a=t.removeJoin,t=t.Field),e.Filter.forEach(function(e,a){e.Expression.Field==t&&e.Expression.Value==(void 0!==n?n:e.Expression.Value)&&e.Expression.Entity==(void 0!==i?i:e.Expression.Entity)&&(r.push(a),i&&s.push(i))});for(var o=r.length;o--;)e.Filter.splice(r[o],1);return a&&s.length&&s.forEach(function(t){var n=0;e.Filter.forEach(function(e){e.Expression.Entity&&e.Expression.Entity==t&&(n+=1)}),n&&e.removeJoin(t)}),this},this.removeJoin=function(t){var n=-1;e.Joins.forEach(function(e,i){e.Table1!=t&&e.Table2!=t||(n=i)}),n>-1&&e.Joins.splice(n,1)},this.removeFilterOLD=function(t,n){var i=-1;e.Filter.forEach(function(e,r){var a=e.Expression;a.Field==t&&(a.Entity=n||a.Entity)&&(i=r)}),i>-1&&e.Filter.splice(i,1)},this.getFilterDescription=function(t){t=t||{};let n=[];return e.Filter.forEach(function(e){let i="";t.field?e.Expression.Field==t.field&&(i=e.getDescription(t)):i=e.getDescription(t),""!=i&&n.push({field:e.Expression.Field,label:i})}),(n=(n=new wire.data.DataTable(n).select().orderBy("field").rows()).map(e=>e.label)).join(", ")},this.getFilterFieldValues=function(t){return e.filterValues(t)},this.filterValues=function(t){var n=[];return e.Filter.forEach(function(e){"FieldExpression"!=e.Expression.__typeName&&e.Expression.Field==t&&(Array.isArray(e.Expression.Value)?n=n.concat(e.Expression.Value):n.push(e.Expression.Value))}),n},this.fromScript=function(e){return new Function("return wire.data.{0};".format(e))()},this.toScript=function(){var e=[],t=[],n=[],i=[],r=this,a="select()";return r.Top>0&&(a+=".top({0})".format(r.Top)),r.Distinct>0&&(a+=".distinct()"),r.Fields.forEach(function(t){var n='.field("{0}")'.format(t.Name);t.Alias&&(n+='.as("{0}")'.format(t.Alias)),e.push(n)}),e.length>0&&(a+=e.join("")),a+=".from(",1==r.Entities.length?a+='"{0}")'.format(r.Entities[0].Name):(r.Entities.forEach(function(e){var n='.entity("{0}")'.format(e.Name);e.Qualifier&&(n+=",{0}".format("number"==typeof e.Qualifier?e.Qualifier:'"'+e.Qualifier+'"')),t.push(n+")")}),a+=")"+t.join(".")),r.Expand.length>0&&(a+='.expand("'+r.Expand.join('","')+'")'),r.OrderBy.forEach(function(e){a+='.orderBy("{0}", {1})'.format(e.Field,!!e.Desc)}),r.GroupBy.forEach(function(e){i.push(e.Field||e)}),i.length>0&&(a+='.groupBy("'+i.join('","')+'")'),r.Filter.forEach(function(e){e.Expression.tojSQL&&n.push(e.Expression.tojSQL())}),n.length&&(a+=".where(){0}".format(n.join("."))),a},this},DataTable:function(e,t){var n=this,r=[],a=0,s=null,o=null;function l(e){return a&&(e=e.slice(0,a)),e}function u(e,t){n.Rows.forEach(function(n){n[e]=t})}function c(e){var t=wire.expression,i=n.Columns;e&&(i=[e]),i.forEach(function(e){if(e.Expression)try{n.Rows.forEach(function(n,i,r){n[e.Name]=t.eval(e.Expression,n,i,r)})}catch(e){}})}return this.__meta={},this.Name=null,this.Id=null,this.Columns=[],this.Rows=[],this.__typeName="DataTable",this.dataTable=function(e){var t=n;return e&&e.distinct&&(t=t.distinct().table()),e&&e.name&&(t.Name=e.name),t},this.exists=function(){return n.count()>0},this.scaler=function(){var e=n.first();for(var t in e)return e[t]},this.first=function(){var e=n.rows();return e?e[0]:null},this.firstOrDefault=function(){return n.first()||n.newRow()},this.count=function(){var e=n.rows();return e?e.length:0},this.rows=function(){var e;return e=o&&o.length?n.table().Rows:l(e=s||n.Rows),s=null,o=null,e},this.table=function(){var e;if(s||o)if(o){s=s||n.Rows;var t=[],i={},r={};o.forEach(function(e){e.as=e.as||e.name}),s.forEach(function(e,n,a){var s="",l={};o.forEach(function(t){t.agg||(s+=e[t.name],l[t.as]=e[t.name])}),i[s]?l=i[s]:(i[s]=l,t.push(l)),o.forEach(function(t){var i=t.name,s=t.as,o=t.exp?wire.expression.eval(t.exp,e,n,a):e[i];switch(t.agg){case"sum":l[s]=l[s]?l[s]- -o:o;break;case"count":var u=void 0===o?1:o?1:0;l[s]=l[s]?l[s]+u:u;break;case"dcount":u=o?1:"_dcount"!=t.name?0:1;"_dcount"==t.name&&(r[s+o]=null),l[s]=l[s]?r[s+o]?l[s]:l[s]+u:u,o&&(r[s+o]=1);break;case"max":l[s]=l[s]?o>l[s]?o:l[s]:o;break;case"min":l[s]=l[s]?o<l[s]?o:l[s]:o;break;case"avg":var c=o||0;u=o?1:0;l[s]=l[s]?l[s]- -c:c,l[s+"avg"]=l[s+"avg"]?l[s+"avg"]+u:u;break;default:l[s]=void 0===o?t.v:o}})}),t.forEach(function(e){o.forEach(function(t){"avg"==t.agg&&(e[t.as]=void 0!==e[t.as+"avg"]?e[t.as]/(e[t.as+"avg"]>0?e[t.as+"avg"]:1):null,delete e[t.as+"avg"])})});var a=[];o.forEach(function(e){var t=n.getColumn(e.name);t?(void 0!==e.Format&&(t.Format=t.Format||e.Format),e.as?(t.Name=e.as,t.Title=e.Title||t.Title):e.Title&&(t.Title=e.Title)):t={Name:e.as||e.name,Title:e.Title,Format:e.Format,DataType:e.DataType},a.push(t)}),e=new wire.data.DataTable(t,a)}else e=new wire.data.DataTable(s,n.Columns);else e=new wire.data.DataTable(this.Rows,this.Columns);return e.Rows=l(e.Rows),s=null,o=null,e.__meta=n.__meta,e},this.refresh=function(e,t){Array.isArray(e)?n.Rows=e:n.Rows=[e];var i=[];if(t)i=t;else for(var r in n.Rows[0])i.push(r);return n.Columns=[],i.forEach(function(e){var t="object"==typeof e?e:n.getColumn(e);t?t.Title||(t.Title=t.Name.splitUpperCaseSpace()):t={Name:e,Title:e.indexOf(" ")>-1?e:e.splitUpperCaseSpace()},n.Columns.push(t)}),this},this.newRow=function(){var e={};if(n.Rows.length>0)for(var t in e=$.extend(e,n.Rows[0]))e[t]=null;else n.Columns.forEach(function(t){e[t.Name]=null});return e},this.replace=function(e,t,i){var r=new wire.Collection(e,n.Rows);n.Rows[r.index(t)]=i},this.insert=function(e,t){var i=e;Array.isArray(e)||(i=[i]);var r=[];i.forEach(function(e){r.push($.extend(n.newRow(),e))});var a=0==n.Rows.length;return t?Array.prototype.unshift.apply(n.Rows,r):Array.prototype.push.apply(n.Rows,r),a&&n.refresh(n.Rows,n.Columns),c(),this},this.delete=function(){return this.eq=function(e,t){for(var i=n.Rows.length;i--;)n.Rows[i][e]==t&&n.Rows.splice(i,1);return this},this.ne=function(e,t){for(var i=n.Rows.length;i--;)n.Rows[i][e]!=t&&n.Rows.splice(i,1);return this},this.calc=function(e){for(var t=wire.expression,i=n.Rows.length;i--;)t.eval(e,n.Rows[i],i,n.Rows)&&n.Rows.splice(i,1);return this},this},this.update=function(e,t){return void 0!==t&&(u(e,t),c()),this.value=function(t){return u(e,t),c(),this},this.calc=function(t){var i=wire.expression;return n.Rows.forEach(function(n,r,a){n[e]=i.eval(t,n,r,a)}),c(),this},this},this.join=function(e){return this.on=function(t,i){var r=[];return i||(i=t),n.Rows.forEach(function(n){e.where().eq(i,n[t]).rows().forEach(function(e){var t=$.extend({},n);for(var a in e){var s=a;t.hasOwnProperty(a)&&a!=i&&(s+="_2"),t[s]=e[a]}r.push(t)})}),new wire.data.DataTable(r)},this},this.leftJoin=function(e){return this.on=function(t,i){var r=[];return i||(i=t),n.Rows.forEach(function(n){var a=!1;if(e.where().eq(i,n[t]).rows().forEach(function(e){var t=$.extend({},n);for(var s in e){var o=s;t.hasOwnProperty(s)&&s!=i&&(o+="_2"),t[o]=e[s]}r.push(t),a=!0}),!a){var s=$.extend({},n);for(var o in e.Rows[0]){var l=o;s.hasOwnProperty(o)&&o!=i&&(l+="_2"),s[l]=null}r.push(s)}}),new wire.data.DataTable(r)},this},this.select=function(e){var t;o=[];for(var i=arguments,r=0;r<i.length;r++)o.push({name:i[r],agg:null,as:i[r]});return this.value=function(e){return t.v=e,this},this.calc=function(e){return t.exp=e,this},this.as=function(e){return t&&(t.as=e),this},this.format=function(e){return t&&(t.Format=e),this},this.column=function(e){return"object"==typeof e?(t=e).name=t.Name:(t={}).name=e,t.agg=null,o.push(t),this},this.columns=function(e){return e.forEach(e=>{n.column(e)}),this},this.count=function(e){return t={name:e,agg:"count"},o.push(t),this},this.distinctCount=function(e){return t={name:e||"_dcount",agg:"dcount"},o.push(t),this},this.sum=function(e){return t={name:e,agg:"sum"},o.push(t),this},this.max=function(e){return t={name:e,agg:"max"},o.push(t),this},this.min=function(e){return t={name:e,agg:"min"},o.push(t),this},this.avg=function(e){return t={name:e,agg:"avg"},o.push(t),this},this},this.orderBy=function(e,t){var i=e;return s=(s=s||n.Rows).sort(function(e,t){return e[i]<t[i]?-1:e[i]>t[i]?1:0}),t&&s.reverse(),this},this.where=function(){var e=n.Rows;return n.count=function(){var e=n.rows();return e?e.length:0},this.calc=function(t){return s=[],e.forEach(function(e,n,i){wire.expression.eval(t,e,n,i)&&s.push(e)}),e=s,this},this.ne=function(t,n){return s=[],e.forEach(function(e){(void 0!==e[t]?e[t]:null)!=n&&s.push(e)}),e=s,this},this.contains=function(t,n){return s=[],e.forEach(function(e){(e[t]?e[t].Value||e[t]:null).toLowerCase().indexOf(n.toLowerCase())>-1&&s.push(e)}),e=s,this},this.between=function(t,n,i){s=[];const r=wire.isNumeric(n),a=wire.isNumeric(i),o=wire.isDate(n),l=wire.isDate(i);return o&&l&&(n=Date.parse(n),i=Date.parse(i)),e.forEach(function(e){var u=void 0!==e[t]?e[t]:null;r&&a?u=parseInt(u):o&&l&&(u=Date.parse(u)),u>=n&&u<=i&&s.push(e)}),e=s,this},this.starts=function(t,n){s=[];var i=n.toLowerCase().length;return e.forEach(function(e){(void 0!==e[t]?e[t]:null).toLowerCase().substring(0,i)==n&&s.push(e)}),e=s,this},this.eq=function(t,n){s=[];var i=Array.isArray(n)?n:[n],r=wire.isNumeric(i[0]);return r&&i.forEach(function(e,t){i[t]=parseInt(e)}),e.forEach(function(e){var n=void 0!==e[t]?e[t]:null;r&&(n=parseInt(n)),i.indexOf(n)>-1&&s.push(e)}),e=s,this},this.in=function(e,t){return this.eq(e,t)},this},this.nonEmpty=function(){var e=o?$.map(o,function(e){return e.name}):n.columnNameArray();return s=s||[],n.Rows.forEach(function(t){var n=!0;for(var i in e){if(t[i]&&t[i].length>0){n=!1;break}n&&s.push(t)}}),this},this.distinct=function(e){var t=[];if(e){var r=arguments;for(i=0;i<r.length;i++)t.push(r[i])}else t=o?$.map(o,function(e){return e.name}):n.columnNameArray();var a,l={},u=[];return(s=s||n.Rows).forEach(function(e){a="",t.forEach(function(t){"object"!=typeof e[t]&&"function"!=typeof e[t]&&(a+=e[t]+""?e[t]:"n")}),l[a]||(u.push(e),l[a]=1)}),s=u,this},this.top=function(e){return a=e,this},this.distinctArray=function(e){var t=[];return n.Rows.forEach(function(n){-1==t.indexOf(n[e])&&t.push(n[e])}),t},this.addLookupColumn=function(e,t,i){var r,a=n.getColumn(i);if(a&&(r=n.addColumn({Name:e,Title:a.Title||a.Name,DataType:"Lookup",Lookup:{Data:t,Column:i}}),a.LookupColumn=e,"object"==typeof t[0])){var s=new wire.data.DataTable(t);n.Rows.forEach(function(t){t[e]=s.first().eq("Id",t[i]).Name})}return r},this.addColumn=function(e,t){var i=n.getColumn(e);return i||(void 0===(i=e.Name?e:{Name:e}).Title&&(i.Title=-1==i.Name.indexOf(" ")?i.Name.splitUpperCaseSpace():i.Name),n.Columns.push(i)),t?u(e,t):n.Rows.forEach(function(e){e[i.Name]||(e[i.Name]=null)}),this.value=function(e){return u(i.Name,e),this},this.format=function(e){return i.Format=e,this},this.type=function(e){return i.DataType=e,this},this.title=function(e){return i.Title=e,this},this.index=function(){return this.calc(function(e,t){return t})},this.calc=function(e){return i.Expression=e,c(i),this},this},this.removeColumn=function(e){var t=new wire.Collection("Name",n.Columns).index(e);return t>-1&&n.Columns.splice(t,1),n.Rows.forEach(function(t){delete t[e]}),this},this.renameColumn=function(e,t){var i=n.getColumn(e);return i&&(i.Name=t,n.Rows.forEach(function(n){n[t]=n[e],delete n[e]})),this},this.getColumn=function(e){if(!e)return null;var t=n.Columns,i=null,r=e.Name||e;return t.some(function(e){return(e.Name||e)==r&&(i=e),null!=i}),i},this.getColumnTitle=function(e){var t=n.getColumn(e);return t?t.Title||t.Name:null},this.columnEmptyArray=function(){var e=[];return n.Rows.forEach(function(t){for(var n in t)t[n]&&0!=t[n].length||-1!=e.indexOf(n)||e.push(n)}),e},this.columnNameArray=function(){var e=[];for(var t in n.Rows[0])e.push(t);return 0==e.length&&n.Columns.forEach(function(t){e.push(t.Name)}),e},this.columnTitleArray=function(){var e=[];return n.Columns.forEach(function(t){e.push(t.Title||t.Name.splitUpperCaseSpace())}),e},this.valueArray=function(){var e=[],t=[];return e.push(n.getColumnNameArray()),this.Rows.forEach(function(n){for(var i in t=[],n)t.push(n[i]);e.push(t)}),e},this.on=function(e,t){e.split(" ").forEach(function(n){r.push({e:e,cb:t})})},(e||t)&&this.refresh(e,t),this},DataModel:function(e){var t=this;this.Measures=null,this.Dimensions=null,this.Entities=[],this.Fields=[],this.Relationships=[],this.getEntity=function(e){return new wire.data.DataTable(t.Entities).where().eq("Name",e).first()},this.setEntity=function(e){new wire.data.DataTable(t.Entities).where().eq("Name",e.Name).first()||t.Entities.push(e)},this.getField=function(e,n){var i=e;"string"==typeof e&&(i={Name:e,Entity:n});var r=new wire.data.DataTable(t.Fields).where().eq("Name",i.Name);return i.Entity&&r.eq("Entity",i.Entity),r.first()},this.setField=function(e){new wire.data.DataTable(t.Fields).where().eq("Name",e.Name).eq("Entity",e.Entity).first()||t.Fields.push(e)},this.getMeasure=function(e){return t.Measures},this.getDimension=function(e){var n;if(t.Dimensions.array().some(function(t){return null!=(n=t.Fields&&t.Fields.indexOf(e)>-1?t:null)}),n){return $.extend({Id:"Id",ParentId:null,Levels:[],LevelDepth:"LevelDepth",Fields:[]},n)}},$.extend(this,e),t.Measures&&(this.Measures=new wire.Collection("Name",this.Measures||[])),t.Dimensions&&(this.Dimensions=new wire.Collection("Key",this.Dimensions||[]))},provider:{Providers:{},register:function(e){e&&(wire.data.provider.Providers[e.id]=e)},dataTable:function(){return new wire.data.DataTable(wire.data.provider.providerArray())},providerArray:function(){var e=[];for(p in wire.data.provider.Providers)e.push(wire.data.provider.Providers[p]);return e}}},wire.data.delete=function(){return new wire.data.TableDelete},wire.data.select=function(){var e=new wire.data.TableQuery;if(arguments&&arguments.length>0)for(i=0;i<arguments.length;i++)e.field(arguments[i]);return e},wire.data.call=function(e){return wire.data.select().from(e).where()},wire.data.procedure=function(e){var t=new wire.data.StoredProcedure(e);return arguments&&arguments.length>0&&(t.Name=arguments[0]),t},wire.data.DataModel.cast=function(e){return e.getField?e:$.extend(new wire.data.DataModel,e)},wire.data.DataTable.cast=function(e){var t=$.extend(new wire.data.DataTable,e);return t.refresh(t.Rows,t.Columns),t},wire.data.TableQuery.cast=function(e){if("function"==typeof e.from)return e;var t=$.extend(new wire.data.TableQuery,e);return t.Filter.forEach(function(e,n){e=$.extend(new wire.data.FilterSelection,e),t.Filter[n]=e;const i=wire.data.QueryExpression.cast(e.Expression);i&&(e.Expression=i)}),t},wire.data.StoredProcedure.cast=function(e){return $.extend(new wire.data.StoredProcedure,e)},wire.data.DataSet.cast=function(e){var t=$.extend(new wire.data.DataSet,e);if(t.Source&&(t.Source=wire.data.DataSource.cast(t.Source)),t.Query)switch(t.Query.__typeName){case"StoredProcedure":t.Query=wire.data.StoredProcedure.cast(t.Query);break;case"TableQuery":t.Query=wire.data.TableQuery.cast(t.Query);break;case"PivotQuery":eb.model&&(t.Query=eb.model.PivotQuery.cast(t.Query))}return t.setTransform(),t.initialize()},wire.data.DataSource.cast=function(e){var t=$.extend(new wire.data.DataSource,e);return"local"==t.Provider&&(t.Provider.Data=wire.data.DataTable.cast(t.Provider.Data)),t.Model&&(t.Model=wire.data.DataModel.cast(t.Model)),t},wire.data.FilterSelection.cast=function(e){return $.extend(new wire.data.FilterSelection,e)},wire.data.EqualsExpression=function(e,t,n){return new wire.data._EqualsExpression(e,t,n,!1)},wire.data.NotEqualsExpression=function(e,t,n){return new wire.data._EqualsExpression(e,t,n,!0)},wire.ui={spinner:function(e,t){var n,i,r,a=this,s=$(e||document.body),o=0,l=wire.guidDom(),u={css:{size1:"fa fa-circle-o-notch fa-spin fa-lg",size2:"fa fa-circle-o-notch fa-spin fa-2x",size3:"fa fa-circle-o-notch fa-spin fa-3x",size4:"fa fa-circle-o-notch fa-spin fa-4x",size5:"fa fa-circle-o-notch fa-spin fa-5x"},size:3};return this.size=function(e){return e&&(r=e),n=1==r?24:50,i=1==r?12:0,this},this.on=function(){return setTimeout(function(){var e=$("<div >",{id:l,style:"z-index:10000",class:"wire-spinner {0} {1}".format(u.css["size"+r],u.css.extra||"")}).appendTo(document.body);if(s.offset()){var t=s.offset().left/330;e.css({top:s.offset().top+(s.innerHeight()-n)/2,left:s.offset().left-t+(s.width()+i)/2}),s.addClass("wire-spinner-bg"),s.prop("wire-spinner-on",!0)}},200),a},this.off=function(){return $(document.body).find("#"+l).remove(),s.removeClass("wire-spinner-bg"),s.prop("wire-spinner-on")?s.prop("wire-spinner-on",!1):(o+=1)<5&&setTimeout(a.off,100),a},t&&wire.merge(u,t),a.size(u.size),a},Component:function(element,config,defaults){var cfg2=null,self=this,_config=null,_data,_ready=!1,ld,pluginEvents={};function initPluginEvents(e){pluginEvents={};const t=e.pluginEvents.root,n=e.pluginEvents.events,i=_config[t];for(const e in n)pluginEvents[e]={cmp:n[e],user:i[e]},i[e]=function(t,n,i,r,a){const s=pluginEvents[e].user;pluginEvents[e].cmp.call(this,t,n,i,r,a),s&&s.call(this,t,n,i,r,a)}}function getDataRef(){var cg=self.config(),dp=cg.data,fd=cg.field;if("string"==typeof dp){var dp2=wire.data.DataManager.DataSets.get(dp);dp2&&(cg.data=dp2,dp=dp2)}if(!dp&&!fd)throw"No data reference specified";return fd?ds():vw();function ds(){var q,source=eval(fd.source),ismodel="model"==source.Type.toLowerCase(),lv=[0,1];if(fd.levels)for(lv=[],i=0;i<fd.levels;i++)lv.push(i);q=ismodel?$pivotquery.select().onrows().dimension(fd.name).levels(lv).oncols().measure().from(fd.model):$tablequery.select(fd.name).from(fd.table);var dset=new wire.data.DataSet({Events:[{Name:"dataselect",Listen:!1}],Source:source,Query:q});return cg.dataConfig||(cg.dataConfig={}),ismodel?(cg.dataConfig.dimension=cg.dataConfig.dimension||fd.name,dset.dimensionTable):(cg.dataConfig.name=cg.dataConfig.name||fd.name,cg.dataConfig.distinct=cg.dataConfig.distinct||fd.distinct,dset.dataTable)}function vw(){var d=self.config().data;if(d.view&&(d=d.view),Array.isArray(d))return new wire.data.DataTable(d);if(d.isDataSet)return d.dataTable;if("string"!=typeof d)return d;var ev=null;eval(d)instanceof wire.data.DataSet&&(d+=".dataTable");try{ev=eval(d)}catch(e){}if(null==ev||void 0===ev)throw"Unable to resolve view reference from "+d;return ev}}function setConfig(){var e=element.data(),t=defaults||{};e&&e.options&&(t=$.extend(!0,t,e.options)),config&&wire.merge(t,config),void 0===t.panel&&(t.panel=!1),_config=t}this.__typeName="Component",this.plugin=null,this.initialize=function(e){if(config=(cfg2=e).config.user,!cfg2.element)throw"Missing selector config.element property";if(_ready=!1,(element=$(cfg2.element)).length||(element=$("#"+cfg2.element)),!element.length)throw"Element '{0}' not found on the page".format(cfg2.element);defaults=cfg2.config.default,setConfig(),wire.ui.prependClass(element,(cfg2.cssClass?cfg2.cssClass+" ":"")+"wire-component"),e.pluginEvents&&initPluginEvents(e),cfg2.dataBind&&wire.toBoolean(self.config().autoBind,!0)&&this.bindData(cfg2.dataBind)},this.element=function(){return element?element.get(0):null},this.$element=function(){return element},this.ListenerId=function(e){var t,n=self.config();n.data.Events&&(t=new wire.Collection("Name",n.data.Events).get(e).ListenerId);return t},this.getEventFunction=function(e){var t=self.config(),n=null;return t.events&&(n="function"==typeof t.events[e]?t.events[e]:t.events[e].callback?t.events[e].callback:null),n},this.eventReady=function(){var e=self.config();_ready||(_ready=!0,setTimeout(function(){element.trigger&&element.trigger("ready",self.config()),e.events&&e.events.ready&&e.events.ready({element:element,config:self.config()})},200)),ld&&ld.off(),ld=null},this.eventDataBind=function(){var e=self.config();setTimeout(function(){(element.trigger&&element.trigger("databind"),e.events&&(e.events.databind||e.events.dataBind))&&(e.events.databind||e.events.dataBind)({element:element,config:self.config(),data:self.data()})},200),ld&&ld.off(),ld=null},this.isReady=function(){return _ready},this.ready=function(e){self.eventReady(),self.eventDataBind()},this.model={val:function(e){const t=self.config();if(t.model){var n=t.model;return void 0!==e&&("number"==n.type&&(Array.isArray(e)?e.forEach(function(t,n){isNaN(e[n])||(e[n]=+e[n])}):isNaN(e)||(e=+e)),"date"==n.type&&(Array.isArray(e)?e.forEach(function(t,n){"function"!=typeof e[n].getMonth&&(e[n]=new Date(e[n]))}):"function"!=typeof e.getMonth&&(e=new Date(e))),n.ko?n.ko(e):n.obj[n.property]=e),n.ko?n.ko():n.obj[n.property]}return null},clear:function(){const e=self.config();if(e.model){var t=null,n=e.model;return"number"==n.type&&(t=void 0!==n.null?n.null:0),self.model.val(t)}return null},toNumber:function(e){const t=self.config();return t.model&&"number"==t.model.type&&!isNaN(e)&&(e=+e),e}},this.ensureArray=function(e){var t=e;return Array.isArray(t)||(t=t.indexOf(",")>-1?$.map(t.split(","),$.trim):[t.trim()]),t},this.color=function(){var e=self.config();return e&&e.color?e.color:"default"},this.getTitle=function(){var e=self.config();return e.panel&&e.panel.title||e.title||e.label||self.nameRef().Name||""},this.select=function(){var e=(i=self.config()).select,t=i.fields,n=i.hide;if(e?"string"==typeof e&&(e=e.split(",")):e=this.data().columnNameArray(),t)for(var i in t){var r=e.indexOf(i);r>-1&&void 0!=t[i].visible&&!t[i].visible&&e.splice(r,1)}return n&&(Array.isArray(n)||(n=[n]),n.forEach(function(t){var n=e.indexOf(t);n>-1&&e.splice(n,1)})),e},this.fields=function(){if(cfg2)return self.updateFieldSchema(cfg2.fields)},this.updateFieldSchema=function(e){var t=self.config(),n=t.map||t.schema||t.fields,i=e;for(var r in i)i[r]=n&&n[r]||i[r];return i},this.configRow=function(e){return self.schemaRow(e)},this.schemaRow=function(e){var t=self.config();return{val:function(n){var i=t[n]||e[n];return"string"==typeof i?i.eval(e):i}}},this.dataBind=function(e,t){this.bindData(e,t)},this.bindData=function(e,t){var n=getDataRef(),i=self.config(),r=element;function a(){wire.toBoolean(i.spinner,!0)&&!ld&&element.is(":visible")&&(ld=new wire.ui.spinner(r).size(i.spinner&&i.spinner.size?i.spinner.size:3).on())}function s(n){var i=self.config();ld&&(ld.off(),ld=null),n?i.events&&i.events.fail&&i.events.fail(n,t):e(t)}"function"==typeof n&&(n=n(i.dataconfig)),n.done?(a(),n.done(function(e){_data=e,s()}).processing(function(){a()}).fail(function(e){s(e),void 0!==wire.bsErrorModal?wire.bsErrorModal(e):(e.Message&&alert(e.Message),console.log(e))})):(_data=n,s())},this.data=function(e){return e&&(_data=e),_data},this.table=function(){return _data},this.colId=function(e){return self.data().getColumn(e.id)?e.id:e.name},this.nameId=function(){var e=self.nameRef();return e.Id||e.Name},this.nameRef=function(){var e=self.config(),t=e.map||e.schema,n={};if(t&&(t.id||t.name))n.Name=t.name,n.Id=t.id;else{var i=self.data();i&&(i.Id||i.Name)&&(n.Name=i.Name,n.Id=i.Id)}return n},this.config=function(){return _config||setConfig(),_config}},prependClass:function(e,t){for(var n=$(e).attr("class")||"",i=n.split(" "),r=(t=t.split(" ")).length-1;r>=0;r--){var a=t[r];i.indexOf(a)>-1&&t.splice(r,1)}e.attr("class",(t.join(" ")+" "+n).trim())},eval:function(e,t){function n(e){let n=e.text();-1==e.html().indexOf("<")&&(n=wire.expression.eval(n,t),e.text(n))}n($(e)),function e(t){t.children().each(function(){n($(this)),e($(this))})}($(e))},config:{tableExport:{downloadUrl:"//service.eblocks.com/serve/download"},styles:{drillExpand:"wire-icon-drill-expand",drillCollapse:"wire-icon-drill-collapse",drillNone:"wire-icon-drill-none"}}},wire.ui.validate=function(e){let t=e.field,n=e.value,i=null,r=e.error,a="";if(null!=n&&""!==n)switch(t.type){case"regex":(a=new RegExp(t.exp)).test(n)||(i=r||"Failed regular expression evaluation");break;case"phone":(a=new RegExp("^\\(?([0-9]{3})\\)?[-. ]?([0-9]{3})[-. ]?([0-9]{4})$")).test(n)||(i=r||"Invalid phone number");break;case"email":(a=new RegExp("^[\\w-\\.]+@([\\w-]+\\.)+[\\w-]{2,}$")).test(n)||(i=r||"Invalid email address");break;case"date":!n instanceof Date&&(i=r||"Must be a valid date");break;case"number":isNaN(n)&&(i=r||"Must be a valid number"),void 0!==t.gt&&n<=t.gt&&(i=r||"Must be greater than {0}".format(t.gt));break;case"value":(t.case?t.values.indexOf(n)>-1:t.values.indexOf(n.toLowerCase())>-1||t.values.indexOf(n.toUpperCase())>-1)||(i=r||"Must be one of the following: {0}".format(t.values.join(",")));break;case"custom":t.validate&&(i=t.validate(t))}return!wire.isBoolean(t.required,!1)||""!==n&&null!=n||(i="Required field"),i},wire.ui.Component.create=function(e){let t=window;if(e.split(".").forEach(e=>{t&&(t=t[e])}),t)return new t;throw"Unable to find the object {0}".format(e)},wire.ui.Component.extend=function(e){var t=new wire.ui.Component,n=Object.create(t);return $.extend(n,e)},wire.data.LocalServiceProvider=function(e){var t=this;function n(t,n){var i=e.dataSource.Provider.Data,r=e.dataSource.Provider.Json,a=e.dataSource.Provider.Csv;switch(!0){case null!=i:o();break;case"object"==typeof r:n?wire.get(r.url).done(function(e){i=e,o()}).fail(function(e){throw console.log(e),"Unable to load data from Json Url: "+r.url}):i=wire.getWait(r.url);break;case"object"==typeof a:function s(){let e=a.papa||{};e.complete=function(e){i=e,o()},e.error=function(e){throw console.log(e),"Unable to load data from csv Url: "+a.url},Papa.parse(a.url,e)}"undefined"==typeof Papa?wire.loadJs("https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js",function(){s()}):s();break;default:throw"Unable to obtain data reference in local service provicer"}function o(){if(!i)return i=new wire.data.DataTable,n&&n(i),i;if("DataTable"!=i.__typeName&&(i=new wire.data.DataTable(i)),i.Rows.length)for(var e in i.Rows[0])i.getColumn(e)||i.addColumn(e);var r=$.extend({},i);t.Fields&&t.Fields.length>0&&(r.select(),t.Fields.forEach(function(e){var t=$.extend({},e);r.column(t)})),t.Distinct&&r.distinct(),t.Top>0&&r.top(t.Top);var a={},s={},o={},l={};if(t.Filter.forEach(function(e){var t=e.Expression;switch(t.__typeName){case"EqualsExpression":a[t.Field]=a[t.Field]||[],a[t.Field].push(t.Value);break;case"BetweenExpression":l[t.Field]=l[t.Field]||[],l[t.Field].push([t.Value1,t.Value2]);break;case"InExpression":a[t.Field]=a[t.Field]||[],a[t.Field]=a[t.Field].concat(t.Value);break;case"ContainsExpression":s[t.Field]=t.Value;break;case"StartsExpression":o[t.Field]=t.Value}}),t.Filter.length){for(var u in r.where(),a)r.eq(u,a[u]);for(var u in l)l[u].forEach(e=>{r.between(u,e[0],e[1])});for(var u in s)r.contains(u,s[u]);for(var u in o)r.starts(u,o[u])}t.OrderBy.length>0&&r.orderBy(t.OrderBy[0].Field,t.OrderBy[0].Desc);var c=r.table();if(t.Paging.Page){var d=c.Rows.length,f=t.Paging.Rows||10,h=(t.Paging.Page-1)*(t.Paging.Rows||f);(c=new wire.data.DataTable(c.Rows.slice(h,h+f))).__meta.paging=t.Paging,c.__meta.paging.Rows=f,c.__meta.paging.TotalRows=d}return n&&n(c),c}}this.allow={delete:!1,discover:!0,write:!1,tableQuery:{orderBy:1,groupBy:!1}},this.getResponseTable=function(e){return e},this.exec=function(e){return n(e)},this.execAsync=function(e,t){var i=$.Deferred(),r=i.promise();return setTimeout(function(){n(e,function(e){i.resolve(e,null,t)})},100),r},this.discoverEntities=function(t){var n=e.dataSource.Name||"Local Data";return new wire.data.DataTable([{Name:n,Schema:"local",EntityType:"table",HasChildren:!0,ParentId:0}])},this.discoverEntitiesAsync=function(e){var n=$.Deferred(),i=n.promise();return setTimeout(function(){n.resolve(t.discoverEntities(e))},100),i},this.discoverFields=function(t){var n=new wire.data.DataTable(e.dataSource.Provider.Data.Columns);return n.addColumn("ParentId").value(e.dataSource.Name||"Local Data"),n.addColumn("EntityType").value("field"),n},this.discoverFieldsAsync=function(e){var n=$.Deferred(),i=n.promise();return setTimeout(function(){n.resolve(t.discoverFields(e))},100),i},this.getEntityResponseTable=function(e){return e}},wire.data.provider.register({id:"local",type:"Table",name:"Local Data Service Provider",provider:wire.data.LocalServiceProvider}),wire.data.TableServiceProvider=function(e){var t=this,n=e.dataSource;function i(e){var t=$.extend({},e);if(!n)return t;n.Ajax&&(t=n.Ajax);var i=n.Provider.ServiceId||n.Provider.Connector||null;return i&&n.Provider.SecretKey&&(t.headers={Authorization:"Basic "+window.btoa(i+":"+n.Provider.SecretKey)}),n.Headers&&(t.headers=t.headers?$.extend(t.headers,n.Headers):n.Headers),wire.toBoolean(n.Provider.Custom,!1)||(t.contentType="text/plain"),t}function r(e,t,n){Array.isArray(t)||(t=[t]);var i=a(null);return $.extend(i,{entity:e||null,data:t||null,options:n||null})}function a(e){var t={};if(e)switch(e.__typeName){case"TableQuery":t.query=e;break;case"TableDelete":t.delete=e;break;case"StoredProcedure":t.procedure=e;break;default:throw"Unable to resolve query type"}return n.Provider.ConnectionObject&&(t.connectionObject=n.Provider.ConnectionObject),t}function s(e,t){var i="{0}/{1}/{2}?connection={3}",r=n.ServiceRoot;if(i=i.format(r,n.Provider.AltRoute||"table",e,n.Provider.ConnectionId),t)for(var a in t)i+="&{0}={1}".format(a,t[a]);return i}this.allow={tableQuery:{orderBy:2,groupBy:!0},storedProcedure:!0,discover:!0,test:!0,preview:!0,model:!0},this.getResponseTable=function(e){"string"==typeof e&&(e=JSON.parse(e));var t=wire.data.DataTable.cast(e);return t.Columns.forEach(function(e){switch(e.DataType){case"Int32":e.Type="int";break;case"String":e.Type="string";break;case"Boolean":e.Type="boolean";break;case"Guid":e.Type="guid"}}),t},this.getEntityResponseTable=function(e){"string"==typeof e&&(e=JSON.parse(e));var t=wire.data.DataTable.cast(e);return t.addColumn("Type"),t.Rows.forEach(function(e){switch(e.DataType){case"float":case"smallint":case"tinyint":case"int":case"money":case"real":e.Type="int";break;case"nvarchar":case"nchar":case"char":case"varchar":e.Type="string";break;case"bit":e.Type="boolean";break;case"uniqueidentifier":e.Type="guid";break;default:e.Type=e.DataType}}),t},this.discoverEntities=function(e){var t=wire.postWait(s("discover/tables",e),a(null),i());return wire.data.DataTable.cast(t)},this.discoverEntitiesAsync=function(e){return wire.post(s("discover/entities",e),a(null),i())},this.discoverFields=function(e){var n=wire.postWait(s("discover/fields",e),a(null),i());return t.getEntityResponseTable(n)},this.discoverFieldsAsync=function(e){return wire.post(s("discover/fields",e),a(null),i())},this.discoverCatalogs=function(e){var t=wire.postWait(s("discover/databases",e),a(null),i());return wire.data.DataTable.cast(t)},this.discoverCatalogsAsync=function(e){return wire.post(s("discover/databases",e),a(null),i())},this.discoverProcedures=function(e){var t=wire.postWait(s("discover/procedures",e),a(null),i());return wire.data.DataTable.cast(t)},this.discoverProceduresAsync=function(e){return wire.post(s("discover/procedures",e),a(null),i())},this.discoverProcedureParameters=function(e){var t=wire.postWait(s("discover/parameters",e),a(null),i());return wire.data.DataTable.cast(t)},this.discoverProcedureParametersAsync=function(e){return wire.post(s("discover/parameters",e),a(null),i())},this.test=function(e){return wire.postWait(s("test",e),a(null),i())},this.exec=function(e,n){var r=wire.postWait(s("exec"),a(e),i(n));return t.getResponseTable(r)},this.execAsync=function(e,t){return wire.post(s("exec"),a(e),i(t))},this.write=function(e,t,n){try{var a=wire.postWait(s("write"),r(e,t,n),i());return wire.data.DataTable.cast(a).Rows}catch(e){throw e}},this.writeAsync=function(e,t,n){return wire.post(s("write"),r(e,t,n),i())},this.delete=function(e,t){return wire.postWait(s("delete"),a(e),i())}},wire.data.provider.register({id:"table",type:"Table",name:"On-premise Table Data Service Provider",provider:wire.data.TableServiceProvider}),wire.data.CustomServiceProvider=function(e){var t=e.dataSource;function n(){var e={};return t&&t.Ajax&&(e=t.Ajax),t&&t.Headers&&(e.headers=t.Headers),e}function i(e,n,i){var r={CustomExpression:"{Expression}",EqualsExpression:"{Field}={Value}",StartsExpression:"{Field}={Value}",InExpression:function(e){return"{0}={1}".format(e.Field,e.Value.join("||"))}},a=i&&i.Provider&&i.Provider.UrlTemplate?i.Provider.UrlTemplate:"[root]/[entity][where]",s=wire.expression,o=[],l=[];if(e&&"StoredProcedure"==e.__typeName){n=e.Name;var u=[];e.Params.forEach(function(e){u.push(new wire.data.EqualsExpression(e.Name,e.Value))}),c(u)}else n=n||e.Entity||(e.Entities&&e.Entities.length?e.Entities[0].Name:""),e&&(e.Fields&&e.Fields.length>0&&o.push("$select="+e.Fields.map(function(e){return e.Name})),c(e.Filter));function c(e){e.forEach(function(e){var t=e.Expression,n=t.Field?"{"+t.Field+"}":null;if(n&&a.indexOf(n)>-1&&"EqualsExpression"==t.__typeName)a=a.replace(n,t.Value);else{var i=s.eval(r[t.__typeName],t);l.push(i)}})}if(i&&i.params)for(var d in i.params)l.push(d+"="+i.params[d]);return l.length>0&&o.push(l.join("&")),a=(a=(a=a.replace("[root]",t.Provider.serviceRoot||t.ServiceRoot||"")).replace("[entity]",n)).replace("[where]",o.length?"?"+o.join("&"):"")}this.allow={tableQuery:!0,storedProcedure:!1,discover:!1,test:!0,preview:!1,model:!1},this.getResponseTable=function(e){return new wire.data.DataTable(e)},this.exec=function(e,t){var r=$.extend(n(),t),a=i(e,null,r);return e.Custom?wire.postWait(a,e.Custom,r):wire.getWait(a,r)},this.execAsync=function(e,t){var r=$.extend(n(),t),a=i(e,null,r);return e.Custom?wire.post(a,e.Custom,r):wire.get(a,r)},this.write=function(e,t,r){var a=$.extend(n(),r);return wire.postWait(i(null,e,a),t,a)},this.delete=function(e,t){var r=$.extend(n(),t);return wire.getWait(i(e,null,r),r)},this.test=function(){if(t.Provider.testMethod){var e="{0}/{1}".format(t.ServiceRoot||"",t.Provider.testMethod);return wire.getWait(e,n())}throw"Unable to test this service.  A root service url or test method was not provided."}},wire.data.provider.register({id:"custom",type:"Table",provider:wire.data.CustomServiceProvider});